C51 COMPILER V8.05a   LCD5510_V2                                                           07/27/2017 11:57:30 PAGE 1   


C51 COMPILER V8.05a, COMPILATION OF MODULE LCD5510_V2
OBJECT MODULE PLACED IN .\LCD5510_V2.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\HARDWARE\DEVICES\DISPLAY\LCD5110\LCD5510_V2.C LARGE BROWSE DEBUG OBJE
                    -CTEXTEND PRINT(.\LCD5510_V2.lst) TABS(2) OBJECT(.\LCD5510_V2.obj)

line level    source

   1          #include "LCD5510_V2.H"
   2          #include "../../../BSP/GPIO.h"
   3          #include "../../../BSP/USART1.h"
   4          #include <stdlib.h>
   5          #include <stdio.h>
   6          
   7          
   8           extern unsigned char code Font_code[][6] = {
   9          {0x00,0x00,0x00,0x00,0x00,0x00},// (0)
  10          {0x00,0x00,0x00,0x4F,0x00,0x00},//!(1)
  11          {0x00,0x00,0x07,0x00,0x07,0x00},//"(2)
  12          {0x00,0x14,0x7F,0x14,0x7F,0x14},//#(3)
  13          {0x00,0x24,0x2A,0x7F,0x2A,0x12},//$(4)
  14          {0x00,0x23,0x13,0x08,0x64,0x62},//%(5)
  15          {0x00,0x36,0x49,0x55,0x22,0x50},//&(6)
  16          {0x00,0x00,0x05,0x03,0x00,0x00},//'(7)
  17          {0x00,0x00,0x1C,0x22,0x41,0x00},//((8)
  18          {0x00,0x00,0x41,0x22,0x1C,0x00},//)(9)
  19          {0x00,0x14,0x08,0x3E,0x08,0x14},//*(10)
  20          {0x00,0x08,0x08,0x3E,0x08,0x08},//+(11)
  21          {0x00,0x00,0x50,0x30,0x00,0x00},//,(12)
  22          {0x00,0x08,0x08,0x08,0x08,0x08},//-(13)
  23          {0x00,0x00,0x60,0x60,0x00,0x00},//.(14)
  24          {0x00,0x20,0x10,0x08,0x04,0x02},///(15)
  25          {0x00,0x3E,0x51,0x49,0x45,0x3E},//0(16)
  26          {0x00,0x00,0x42,0x7F,0x40,0x00},//1(17)
  27          {0x00,0x42,0x61,0x51,0x49,0x46},//2(18)
  28          {0x00,0x21,0x41,0x45,0x4B,0x31},//3(19)
  29          {0x00,0x18,0x14,0x12,0x7F,0x10},//4(20)
  30          {0x00,0x27,0x45,0x45,0x45,0x39},//5(21)
  31          {0x00,0x3C,0x4A,0x49,0x49,0x30},//6(22)
  32          {0x00,0x01,0x71,0x09,0x05,0x03},//7(23)
  33          {0x00,0x36,0x49,0x49,0x49,0x36},//8(24)
  34          {0x00,0x06,0x49,0x49,0x29,0x1E},//9(25)
  35          {0x00,0x00,0x36,0x36,0x00,0x00},//:(26)
  36          {0x00,0x00,0x56,0x36,0x00,0x00},//;(27)
  37          {0x00,0x08,0x14,0x22,0x41,0x00},//<(28)
  38          {0x00,0x14,0x14,0x14,0x14,0x14},//=(29)
  39          {0x00,0x00,0x41,0x22,0x14,0x08},//>(30)
  40          {0x00,0x02,0x01,0x51,0x09,0x06},//?(31)
  41          {0x00,0x32,0x49,0x79,0x41,0x3E},//@(32)
  42          {0x00,0x7E,0x11,0x11,0x11,0x7E},//A(33)
  43          {0x00,0x7F,0x49,0x49,0x49,0x3E},//B(34)
  44          {0x00,0x3E,0x41,0x41,0x41,0x22},//C(35)
  45          {0x00,0x7F,0x41,0x41,0x22,0x1C},//D(36)
  46          {0x00,0x7F,0x49,0x49,0x49,0x41},//E(37)
  47          {0x00,0x7F,0x09,0x09,0x09,0x01},//F(38)
  48          {0x00,0x3E,0x41,0x49,0x49,0x7A},//G(39)
  49          {0x00,0x7F,0x08,0x08,0x08,0x7F},//H(40)
  50          {0x00,0x00,0x41,0x7F,0x41,0x00},//I(41)
  51          {0x00,0x20,0x40,0x41,0x3F,0x01},//J(42)
  52          {0x00,0x7F,0x08,0x14,0x22,0x41},//K(43)
  53          {0x00,0x7F,0x40,0x40,0x40,0x40},//L(44)
  54          {0x00,0x7F,0x02,0x04,0x02,0x7F},//M(45)
C51 COMPILER V8.05a   LCD5510_V2                                                           07/27/2017 11:57:30 PAGE 2   

  55          {0x00,0x7F,0x04,0x08,0x10,0x7F},//N(46)
  56          {0x00,0x3E,0x41,0x41,0x41,0x3E},//O(47)
  57          {0x00,0x7F,0x09,0x09,0x09,0x06},//P(48)
  58          {0x00,0x3E,0x41,0x51,0x21,0x5E},//Q(49)
  59          {0x00,0x7F,0x09,0x19,0x29,0x46},//R(50)
  60          {0x00,0x46,0x49,0x49,0x49,0x31},//S(51)
  61          {0x00,0x01,0x01,0x7F,0x01,0x01},//T(52)
  62          {0x00,0x3F,0x40,0x40,0x40,0x3F},//U(53)
  63          {0x00,0x1F,0x20,0x40,0x20,0x1F},//V(54)
  64          {0x00,0x3F,0x40,0x38,0x40,0x3F},//W(55)
  65          {0x00,0x63,0x14,0x08,0x14,0x63},//X(56)
  66          {0x00,0x03,0x04,0x78,0x04,0x03},//Y(57)
  67          {0x00,0x61,0x51,0x49,0x45,0x43},//Z(58)
  68          {0x00,0x00,0x7F,0x41,0x41,0x00},//[(59)
  69          {0x00,0x15,0x16,0x7C,0x16,0x15},//\(60)
  70          {0x00,0x00,0x41,0x41,0x7F,0x00},//](61)
  71          {0x00,0x04,0x02,0x01,0x02,0x04},//^(62)
  72          {0x00,0x40,0x40,0x40,0x40,0x40},//_(63)
  73          {0x00,0x00,0x01,0x02,0x04,0x00},//`(64)
  74          {0x00,0x20,0x54,0x54,0x54,0x78},//a(65)
  75          {0x00,0x7F,0x48,0x44,0x44,0x38},//b(66)
  76          {0x00,0x38,0x44,0x44,0x44,0x20},//c(67)
  77          {0x00,0x38,0x44,0x44,0x48,0x7F},//d(68)
  78          {0x00,0x38,0x54,0x54,0x54,0x18},//e(69)
  79          {0x00,0x08,0x7E,0x09,0x01,0x02},//f(70)
  80          {0x00,0x0C,0x52,0x52,0x52,0x3E},//g(71)
  81          {0x00,0x7F,0x08,0x04,0x04,0x78},//h(72)
  82          {0x00,0x00,0x44,0x7D,0x40,0x00},//i(73)
  83          {0x00,0x20,0x40,0x44,0x3D,0x00},//j(74)
  84          {0x00,0x7F,0x10,0x28,0x44,0x00},//k(75)
  85          {0x00,0x00,0x41,0x7F,0x40,0x00},//l(76)
  86          {0x00,0x7E,0x02,0x0C,0x02,0x7C},//m(77)
  87          {0x00,0x7E,0x04,0x02,0x02,0x7C},//n(78)
  88          {0x00,0x38,0x44,0x44,0x44,0x38},//o(79)
  89          {0x00,0x7C,0x14,0x14,0x14,0x08},//p(80)
  90          {0x00,0x08,0x14,0x14,0x18,0x7C},//q(81)
  91          {0x00,0x7C,0x08,0x04,0x04,0x08},//r(82)
  92          {0x00,0x48,0x54,0x54,0x54,0x20},//s(83)
  93          {0x00,0x04,0x3F,0x44,0x40,0x20},//t(84)
  94          {0x00,0x3C,0x40,0x40,0x20,0x7C},//u(85)
  95          {0x00,0x1C,0x20,0x40,0x20,0x1C},//v(86)
  96          {0x00,0x3C,0x40,0x30,0x40,0x3C},//w(87)
  97          {0x00,0x44,0x28,0x10,0x28,0x44},//x(88)
  98          {0x00,0x0C,0x50,0x50,0x50,0x3C},//y(89)
  99          {0x00,0x44,0x64,0x54,0x4C,0x44},//z(90)
 100          {0x00,0x00,0x08,0x36,0x41,0x00},//{(91)
 101          {0x00,0x00,0x00,0x7F,0x00,0x00},//|(92)
 102          {0x00,0x00,0x41,0x36,0x08,0x00},//}(93)
 103          {0x00,0x08,0x04,0x08,0x10,0x08},//~(94)
 104          {0x00,0x08,0x08,0x2A,0x1C,0x08},//→(127)
 105          {0x00,0x08,0x1C,0x2A,0x08,0x08},//←(128)
 106          {0x00,0x04,0x02,0x7F,0x02,0x04},//↑(129)
 107          {0x00,0x10,0x20,0x7F,0x20,0x10},//↓(130)
 108          {0x00,0x1C,0x2A,0x32,0x2A,0x1C},//笑面(131)
 109          {0x00,0x1C,0x22,0x44,0x22,0x1C}};//爱心(132)
 110          
 111          /*--------------------------------------------------------------*/
 112          //写入一个字节(数据或指令)
 113          //wbyte:  待写入的数据
 114          //dat_cmd:  1-数据, 0-指令
 115          void LCD_write_byte(unsigned char wbyte, unsigned char dat_cmd)
 116          {
C51 COMPILER V8.05a   LCD5510_V2                                                           07/27/2017 11:57:30 PAGE 3   

 117   1        unsigned char i;
 118   1        
 119   1        LCD_CS = 0;     //使能
 120   1        LCD_DC = dat_cmd; //1-数据  //0-指令
 121   1      
 122   1        for(i = 8; i; i--)  //8位数据, 先高后低
 123   1        {
 124   2          if(wbyte & 0x80) {LCD_DIN = 1;}
 125   2          else       {LCD_DIN = 0;}
 126   2          
 127   2          LCD_CLK = 0;
 128   2          wbyte <<= 1;  //移位(延时)
 129   2          LCD_CLK = 1;  //上升沿写入
 130   2        }
 131   1        
 132   1        LCD_CS = 1;     //禁止
 133   1      }
 134          
 135          
 136          /*--------------------------------------------------------------*/
 137          //写入n个字节(数据)(ROM)
 138          //*wbyte: 待写入的数据指针
 139          //num:    待写入的数据个数
 140          /*void LCD_write_nbyte(unsigned char code *wbyte, unsigned char num)
 141          {
 142            unsigned char i, j;
 143            unsigned char temp;
 144          
 145            LCD_CS = 0;     //使能
 146            LCD_DC = 1;     //数据
 147          
 148            for(j = 0; j < num; j++)//num个数据
 149            {
 150              temp = wbyte[j];
 151              for(i = 8; i; i--)  //8位数据, 先高后低
 152              {
 153                if(temp & 0x80) {LCD_DIN = 1;}
 154                else      {LCD_DIN = 0;}
 155              
 156                LCD_CLK = 0;
 157                temp <<= 1;   //移位(延时)
 158                LCD_CLK = 1;  //上升沿写入
 159              } 
 160            }
 161            
 162            LCD_CS = 1;     //禁止
 163          }
 164          
 165          
 166          /*--------------------------------------------------------------*/
 167          //显示清屏(清DDRAM)
 168          void LCD_clr_scr(void)
 169          {
 170   1        unsigned int i;
 171   1        
 172   1        LCD_write_cmd(X_Col_Addr);
 173   1        LCD_write_cmd(Y_Page_Addr);
 174   1        
 175   1        for(i = 504; i; i--) LCD_write_dat(0x00);
 176   1      }
 177          
 178          
C51 COMPILER V8.05a   LCD5510_V2                                                           07/27/2017 11:57:30 PAGE 4   

 179          /*--------------------------------------------------------------*/
 180          //显示清行
 181          //num:  0 - 5
 182          void LCD_clr_row(unsigned char num)
 183          {
 184   1        unsigned char i;
 185   1        
 186   1        LCD_pos_byte(0, num);
 187   1        for(i = 84; i; i--) LCD_write_dat(0x00);
 188   1      }
 189          
 190          
 191          /*--------------------------------------------------------------*/
 192          //液晶字节定位(1*1)
 193          //液晶规划:
 194          //x: 0 - 83
 195          //y: 0 - 5
 196          void LCD_pos_byte(unsigned char x, unsigned char y)
 197          {
 198   1        x |= X_Col_Addr;  
 199   1        y |= Y_Page_Addr; 
 200   1        LCD_write_cmd(x); //列地址
 201   1        LCD_write_cmd(y); //页地址
 202   1      }
 203          
 204          
 205          /*--------------------------------------------------------------*/
 206          //液晶字符输出(6*8字体)
 207          //x: 0 - 13
 208          //y: 0 - 5
 209          void LCD_printc(unsigned char x, unsigned char y, unsigned char c_dat)
 210          {
 211   1        unsigned char i;
 212   1      
 213   1        c_dat -= 32;    //查表
 214   1        x *= 6;       //宽6
 215   1      
 216   1        LCD_pos_byte(x, y); //坐标
 217   1        for(i = 0; i < 6; i++) LCD_write_dat(Font_code[c_dat][i]);  
 218   1      }
 219          
 220          
 221          /*--------------------------------------------------------------*/
 222          //液晶字符串输出(6*8字体)
 223          //x: 0 - 13
 224          //y: 0 - 5
 225          void LCD_prints(unsigned char x, unsigned char y, unsigned char *s_dat)
 226          {
 227   1        while(*s_dat && x < 14) {LCD_printc(x++, y, *s_dat); s_dat++;}
 228   1      }
 229          
 230          
 231          /*--------------------------------------------------------------*/
 232          //液晶字符串输出,自动换行(6*8字体)
 233          //x: 0 - 13
 234          //y: 0 - 5
 235          void LCD_printsl(unsigned char x, unsigned char y, unsigned char *s_dat)
 236          {
 237   1        while(*s_dat) 
 238   1        {
 239   2          LCD_printc(x++, y, *s_dat); 
 240   2          s_dat++;
C51 COMPILER V8.05a   LCD5510_V2                                                           07/27/2017 11:57:30 PAGE 5   

 241   2          if(x == 14) {x = 0; y++;}
 242   2          if(y == 6)  {y = 0;}
 243   2        }
 244   1      }
 245          
 246          
 247          /*--------------------------------------------------------------*/
 248          //复位LCD5510
 249          /*void LCD_reset_5510(void)
 250          {
 251            LCD_clr_scr();        //清全屏
 252            
 253            LCD_write_cmd(0x25);    //省电模式, 水平寻址, 扩展指令
 254            LCD_write_cmd(0x04);    //VLCD温度系数0
 255            LCD_write_cmd(0x10);    //设置偏置系统(BSx)
 256            LCD_write_cmd(0xc0);    //设置电压VLCD = 3.06 + 0.06*Vop;
 257            
 258            LCD_write_cmd(0x24);    //省电模式, 水平寻址, 常规指令
 259            LCD_write_cmd(0x08);    //显示空白
 260            LCD_write_cmd(Y_Page_Addr); //起始页地址0
 261            LCD_write_cmd(X_Col_Addr);  //起始列地址0
 262          }
 263          
 264          
 265          /*--------------------------------------------------------------*/
 266          //初始化LCD5510
 267          void LCD5510_Init(void)
 268          {  
 269   1        GPIO_InitTypeDef    GPIO_InitStructure;     //设置管脚
 270   1          GPIO_InitStructure.Mode = GPIO_PullUp;
 271   1          GPIO_InitStructure.Pin = GPIO_Pin_0|GPIO_Pin_1|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_4;    //lcd5110
 272   1        GPIO_Inilize(GPIO_P5, &GPIO_InitStructure);  
 273   1        LCD_reset_hard;       //硬件复位
 274   1      //  LCD_reset_soft;       //软件复位
 275   1      
 276   1        LCD_write_cmd(0x21);    //工作模式, 水平寻址, 扩展指令
 277   1        LCD_write_cmd(0x06);    //VLCD温度系数2
 278   1        LCD_write_cmd(0x13);    //设置偏置系统(BSx) 1:48
 279   1        LCD_write_cmd(0xc8);    //设置电压VLCD = 3.06 + 0.06*Vop, 对比度调整
 280   1      
 281   1        LCD_write_cmd(0x20);    //工作模式, 水平寻址, 常规指令
 282   1        LCD_write_cmd(0x0c);    //普通模式
 283   1        LCD_write_cmd(Y_Page_Addr); //起始页地址0
 284   1        LCD_write_cmd(X_Col_Addr);  //起始列地址0
 285   1        LCD_clr_scr();        //清全屏
 286   1        PrintString1("LCD5110 was initialized \r\n");
 287   1      }
 288          
 289          /*--------------------------------------------------------------*/
 290            
 291          
 292          
 293          
 294          
 295           


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    377    ----
   CONSTANT SIZE    =    633    ----
   XDATA SIZE       =   ----      12
   PDATA SIZE       =   ----    ----
C51 COMPILER V8.05a   LCD5510_V2                                                           07/27/2017 11:57:30 PAGE 6   

   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
